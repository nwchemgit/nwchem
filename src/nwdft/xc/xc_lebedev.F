      subroutine xc_lebedev(l_ang, oprint)
      implicit none
c
C$Id: xc_lebedev.F,v 1.8 1998-03-24 22:43:11 d3h449 Exp $
c
#include "cdft.fh"
#include "stdio.fh"
#include "global.fh"
#include "tcgmsg.fh"
c
c     Routine for Lebedev weights, supplied by Mauro Causa`
c     n=7 modified by E. Apra based on Turbomole reoptimization of
c     parameters.
c
c     integer iacc  ! [input]
c
      integer MAXN, i
      parameter(MAXN = 61)
      logical oprint
      double precision gjk(2,MAXN), wleb(MAXN), fasf(6), goh(3,3,48)
      integer njk(6,IAC_MAX), ivj(48,IAC_MAX), nvj(6),
     &        jkv(IAC_MAX+1), nridv(IAC_MAX), itop(3,3,6), isig(3,8)
      double precision fourpi
C      parameter(fourpi = 4.d0*3.1415926535897932385d0)
c
      integer nop, n48, iv, k, ks, isi, j, ia, l_ang, iaz, jk, jk1, 
     &        nvjj, l
      double precision wtest, fasfj, x0, y0, z0, gjkt1, gjkt2, gjkt3
c
      data itop/1, 0, 0, 0, 1, 0, 0, 0, 1,  1, 0, 0, 0, 0, 1, 0, 1, 0,
     &          0, 1, 0, 1, 0, 0, 0, 0, 1,  0, 0, 1, 0, 1, 0, 1, 0, 0,
     &          0, 1, 0, 0, 0, 1, 1, 0, 0,  0, 0, 1, 1, 0, 0, 0, 1, 0/
c
      data isig/ 1,  1,  1, -1,  1,  1,  1, -1,  1,  1,  1, -1,
     &          -1, -1, -1,  1, -1, -1, -1,  1, -1, -1, -1,  1/
c
c     n = 9
c
      data wleb( 1), (gjk(i, 1), i = 1, 2)/
     &     0.00952380952397d0, 1.0d0, 0.0d0/
c
      data wleb( 2), (gjk(i, 2), i = 1, 2)/
     &     0.0321428571429, 1.0d0, 1.0d0/
c
      data wleb( 3), (gjk(i, 3), i = 1, 2)/
     &     0.0285714285714d0, 0.888073833977d0, 
     &     0.459700843381d0/
c
c     n = 11
c
      data wleb( 4), (gjk(i, 4), i = 1, 2)/
     &     0.0126984126985d0, 1.0d0, 0.0d0/
c
      data wleb( 5), (gjk(i, 5), i = 1, 2)/
     &     0.0225749559083d0, 1.0d0, 1.0d0/
c
      data wleb( 6), (gjk(i, 6), i = 1, 2)/
     &     0.02109375d0, 1.0d0, 1.0d0/
c
      data wleb( 7), (gjk(i, 7), i = 1, 2)/
     &     0.0201733355379d0, 0.301511344578d0, 
     &     0.301511344578d0/
c
c     n = 17
c
      data wleb( 8), (gjk(i, 8), i = 1, 2)/
     &     0.003828270494940d0, 1.0d0, 0.0d0/
c
      data wleb( 9), (gjk(i, 9), i = 1, 2)/
     &     0.009793737512490d0, 1.0d0, 1.0d0/
c
      data wleb(10), (gjk(i,10), i = 1, 2)/
     &     0.008211737283190d0, 0.1851156353450d0, 
     &     0.1851156353450d0/
c
      data wleb(11), (gjk(i,11), i = 1, 2)/
     &     0.009595471336070d0, 0.3956894730560d0, 
     &     0.3956894730560d0/
c
      data wleb(12), (gjk(i,12), i = 1, 2)/
     &     0.00994281489118d0, 0.690421048382d0, 
     &     0.690421048382d0/
c
      data wleb(13), (gjk(i,13), i = 1, 2)/
     &     0.00969499636166d0, 0.878158910604d0, 
     &     0.478369028812d0/
c
c     n = 23
c
      data wleb(14), (gjk(i,14), i = 1, 2)/
     &     0.00178234044724d0, 1.0d0, 0.0d0/
c
      data wleb(15), (gjk(i,15), i = 1, 2)/
     &     0.00571690594998d0, 1.0d0, 1.0d0/
c
      data wleb(16), (gjk(i,16), i = 1, 2)/
     &     0.00557338317884d0, 1.0d0, 1.0d0/
c
      data wleb(17), (gjk(i,17), i = 1, 2)/
     &     0.00551877146727d0, 0.444693317871d0, 
     &     0.444693317871d0/
c
      data wleb(18), (gjk(i,18), i = 1, 2)/
     &     0.005158237711810d0, 0.2892465627580d0, 
     &     0.2892465627580d0/
c
      data wleb(19), (gjk(i,19), i = 1, 2)/
     &     0.00560870408259d0, 0.671297344270d0, 
     &     0.671297344270d0/
c
      data wleb(20), (gjk(i,20), i = 1, 2)/
     &     0.00410677702817d0, 0.129933544765d0, 
     &     0.129933544765d0/
c
      data wleb(21), (gjk(i,21), i = 1, 2)/
     &     0.00505184606462d0, 0.938319218138d0, 
     &     0.345770219761d0/
c
      data wleb(22), (gjk(i,22), i = 1, 2)/
     &     0.00553024891623d0, 0.836036015482d0, 
     &     0.159041710538d0/
c
c     n = 27
c
      data wleb(23), (gjk(i,23), i = 1, 2)/
     &     -0.00131376912733d0, 1.0d0, 0.0d0/
c
      data wleb(24), (gjk(i,24), i = 1, 2)/
     &     -0.00252272870489d0, 1.0d0, 1.0d0/
c
      data wleb(25), (gjk(i,25), i = 1, 2)/
     &     0.00418685388170d0, 1.0d0, 1.0d0/
c
      data wleb(26), (gjk(i,26), i = 1, 2)/
     &     0.00531516797782d0, 0.703937339159d0, 
     &     0.703937339159d0/
c
      data wleb(27), (gjk(i,27), i = 1, 2)/
     &     0.00425613135143d0, 0.662033866370d0, 
     &     0.662033866370d0/
c
      data wleb(28), (gjk(i,28), i = 1, 2)/
     &     0.00411248239441d0, 0.464744872642d0, 
     &     0.464744872642d0/
c
      data wleb(29), (gjk(i,29), i = 1, 2)/
     &     0.00359558489976d0, 0.327742065497d0, 
     &     0.327742065497d0/
c
      data wleb(30), (gjk(i,30), i = 1, 2)/
     &     0.00404714237709d0, 0.101252624857d0, 
     &     0.101252624857d0/
c
      data wleb(31), (gjk(i,31), i = 1, 2)/
     &     0.00422958270065d0, 0.850650808352d0, 
     &     0.525731112119d0/
c
      data wleb(32), (gjk(i,32), i = 1, 2)/
     &     0.00407146759383d0, 0.819343388819d0, 
     &     0.524493924092d0/
c
      data wleb(33), (gjk(i,33), i = 1, 2)/
     &     0.00408091422578d0,   0.939227930219614d0,  
     &     0.3233484544306744d0/
c
c     n = 29
c
      data wleb(34), (gjk(i,34), i = 1, 2)/
     &     0.000854591172878d0, 1.0d0, 0.0d0/
c
      data wleb(35), (gjk(i,35), i = 1, 2)/
     &     0.00359911928502d0, 1.0d0, 1.0d0/
c
      data wleb(36), (gjk(i,36), i = 1, 2)/
     &     0.00365004580768d0, 0.701176641609d0, 
     &     0.701176641609d0/
c
      data wleb(37), (gjk(i,37), i = 1, 2)/
     &     0.00360482260142d0, 0.656632941022d0, 
     &     0.656632941022d0/
c
      data wleb(38), (gjk(i,38), i = 1, 2)/
     &     0.00357672966173d0, 0.472905413258d0, 
     &     0.472905413258d0/
c
      data wleb(39), (gjk(i,39), i = 1, 2)/
     &     0.00344978842429d0, 0.351564034558d0, 
     &     0.351564034558d0/
c
      data wleb(40), (gjk(i,40), i = 1, 2)/
     &     0.00310895312238d0, 0.221964523631d0, 
     &     0.221964523631d0/
c
      data wleb(41), (gjk(i,41), i = 1, 2)/
     &     0.00235210141366d0, 0.0961830852303d0, 
     &     0.0961830852303d0/
c
      data wleb(42), (gjk(i,42), i = 1, 2)/
     &     0.00360082093222d0, 0.820326419828d0, 
     &     0.571895589188d0/
c
      data wleb(43), (gjk(i,43), i = 1, 2)/
     &     0.00298234496317d0, 0.964408914879d0, 
     &     0.264415288706d0/
c
      data wleb(44), (gjk(i,44), i = 1, 2)/
     &     0.00357154055427d0, 0.251003475177d0, 
     &     0.800072749407d0/
c
      data wleb(45), (gjk(i,45), i = 1, 2)/
     &     0.00339231220501d0, 0.902442529533d0, 
     &     0.412772408317d0/
c
c     n = 35
c
      data wleb(46), (gjk(i,46), i = 1, 2)/
     &     0.52659765761428065D-3, 1.0d0, 0.0d0/
c
      data wleb(47), (gjk(i,47), i = 1, 2)/
     &     0.25482199909403521D-2, 1.0d0, 1.0d0/
c
      data wleb(48), (gjk(i,48), i = 1, 2)/
     &     0.25123173709441058D-2, 1.0d0, 1.0d0/
c
      data wleb(49), (gjk(i,49), i = 1, 2)/
     &     0.25304038224001323D-2, 0.69093463105113458D0,
     &     0.69093463105113458D0 /

c
      data wleb(50), (gjk(i,50), i = 1, 2)/
     &     0.25132671684706878D-2, 0.64566647095194987D0,
     &     0.64566647095194987D0/
c
      data wleb(51), (gjk(i,51), i = 1, 2)/
     &     0.25017251210647733D-2, 0.49143426555639500D0,
     &     0.49143426555639500D0/
c
      data wleb(52), (gjk(i,52), i = 1, 2)/
     &     0.24453733047996786D-2, 0.39272598223217649D0,
     &     0.39272598223217649D0/
c
      data wleb(53), (gjk(i,53), i = 1, 2)/
     &     0.23026944325620758D-2, 0.28612891787658218D0,
     &     0.28612891787658218D0/
c
      data wleb(54), (gjk(i,54), i = 1, 2)/
     &     0.20142782609526094D-2, 0.17748365242374568D0,
     &     0.17748365242374568D0/
c
      data wleb(55), (gjk(i,55), i = 1, 2)/
     &     0.14624950815475142D-2, 0.07568095866244468D0,
     &     0.07568095866244468D0/
c
      data wleb(56),(gjk(i,56), i = 1, 2)/
     &     0.19109513147305082D-2, 0.97764280892098723D0,
     &     0.21027253307334757D0/
c
      data wleb(57), (gjk(i,57), i = 1, 2)/
     &     0.24174423575419847D-2, 0.88181328936054412D0,
     &     0.47159868819488597D0/
c
      data wleb(58), (gjk(i,58), i = 1, 2)/
     &     0.22366077071364263D-2, 0.09921769971362576D0,
     &     0.33443631695748371D0/
c
      data wleb(59), (gjk(i,59), i = 1, 2)/
     &     0.24169300107381179D-2, 0.20548237125466495D0,
     &     0.45023303874296735D0/
c
      data wleb(60), (gjk(i,60), i = 1, 2)/
     &     0.25122368647336706D-2, 0.10680182513533723D0,
     &     0.59051570309804130D0/
c
      data wleb(61), (gjk(i,61), i = 1, 2)/
     &     0.24966440519292456D-2, 0.31042840327515130D0,
     &     0.55501523681448068D0/
c     
      data fasf/6*1.0d0/
c
      data jkv/0, 3, 7, 13, 22, 33, 45, 61/
c     
      data  njk/1, 0, 1, 0, 1, 0,  1, 1, 1, 1, 0, 0,  1, 0, 1, 3, 1, 0,  
     &          1, 1, 1, 4, 1, 1,  1, 1, 1, 5, 1, 2,  1, 0, 1, 6, 2, 2,  
     &          1, 1, 1, 7, 2, 4/
c
      data  nvj/6, 12, 8, 24, 24, 48/
c
      data (ivj(i,1), i = 1, 6)/1, 2, 17, 19, 25, 28/
c
      data (ivj(i,2), i = 1, 12)/
     &     1, 2, 3, 8, 9, 10, 12, 15, 25, 27, 28, 30/
c
      data (ivj(i,3), i = 1, 8)/1, 2, 3, 4, 5, 6, 7, 8/
c
      data (ivj(i,4), i = 1, 24)/
     &      1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 
     &     13, 14, 15, 16, 25, 26, 27, 28, 29, 30, 31, 32/
c
      data (ivj(i,5), i = 1, 24)/
     &      1,  2,  3,  8, 17, 18, 19, 24,  9, 10, 12, 15,
     &     41, 42, 44, 47, 33, 35, 36, 38, 25, 27, 28, 30/
c
      data (ivj(i,6), i = 1, 48)/
     &      1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 
     &     13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 
     &     25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 
     &     37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48/
c
      data (ivj(i,7), i = 1, 48)/
     &      1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 
     &     13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 
     &     25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 
     &     37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48/
c
      data nridv/38, 50, 110, 194, 266, 302, 434/
c
      fourpi=4.0d0*dacos(-1.d0)
      nop = 0
      n48 = 1
      do 57 iv = 1, 6
         do 57 ks = 1, 8
            nop = nop + 1
            do 57  i = 1, 3
               isi = isig(i,ks)
               do 57  j = 1, 3
57    goh(i,j,nop) = isi*itop(i,j,iv)
      fasf(2) = 1.d0/sqrt(2.d0)
      fasf(3) = 1.d0/sqrt(3.d0)
c
      do ia = 1,iangquad
c
         if (ia.le.0) then
            l_ang = 1
            za_leb(1,1,ia) = 1.0d0
            za_leb(2,1,ia) = 0.0d0
            za_leb(3,1,ia) = 0.0d0
            wa_leb(1,ia) = fourpi
         else
            iaz = min(ia,IAC_MAX)
            l_ang = 0
            wtest = 0.d0
            jk = jkv(iaz)
            jk1 = 0
            do 20  j = 1,6
               nvjj = nvj(j)
               fasfj = fasf(j)
               do 20 k = 1,njk(j,iaz)
                  jk = jk + 1
                  jk1 = jk1 + 1
                  x0 = gjk(1,jk)*fasfj
                  y0 = gjk(2,jk)*fasfj
                  gjkt1=x0*x0+y0*y0
                  if(gjkt1.lt.1.d0) then
                    z0=dsqrt(1.d0-gjkt1)
                  else
                    z0=0.d0
                  endif
                  if (oprint)write(LuOut,207)
                  do l = 1,nvjj
                     iv = ivj(l,j)
                     gjkt1 = goh(1,1,iv)*x0 + goh(1,2,iv)*y0 + 
     &                       goh(1,3,iv)*z0
                     gjkt2 = goh(2,1,iv)*x0 + goh(2,2,iv)*y0 + 
     &                       goh(2,3,iv)*z0
                     gjkt3 = goh(3,1,iv)*x0 + goh(3,2,iv)*y0 + 
     &                       goh(3,3,iv)*z0
                     l_ang = l_ang + 1
                     za_leb(1,l_ang,iaz) = gjkt1
                     za_leb(2,l_ang,iaz) = gjkt2
                     za_leb(3,l_ang,iaz) = gjkt3
                     wa_leb(l_ang,iaz) = wleb(jk)*fourpi
                     wtest = wtest + wa_leb(l_ang,ia)
C			write(0,*) ' wtest ', wtest/fourpi
                     if (oprint)write(LuOut,209)wa_leb(l_ang,iaz),
     &                  (za_leb(i,l_ang,iaz),i = 1,3)
                  enddo
   20       continue
            if (oprint)write(LuOut,410)l_ang, wtest/fourpi
         endif
         ntheta(ia) = l_ang
         nphi(ia) = -99
      enddo
      return
  208 format(t10,3f10.5)
  207 format('     reducible set of points ;')
  209 format(t10,f10.5,2x,3f10.5)
  410 format('   total no. of   reducible points:',i4,'; test:',f12.8)
      end

